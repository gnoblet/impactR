<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="impactR">
<title>Data analysis • impactR</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.1.3/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.1.3/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Data analysis">
<meta property="og:description" content="impactR">
<meta property="og:image" content="https://gnoblet.github.io/impactR/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">impactR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.9.2.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/analysis.html">Data analysis</a>
    <a class="dropdown-item" href="../articles/base_de_travail.html">Base de travail avec impactR</a>
    <a class="dropdown-item" href="../articles/cleaning_data.html">Cleaning data</a>
    <a class="dropdown-item" href="../articles/main_workflow.html">Some workflow</a>
    <a class="dropdown-item" href="../articles/nettoyage_de_donnees.html">Nettoyage de données</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/gnoblet/impactR/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Data analysis</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/gnoblet/impactR/blob/HEAD/vignettes/analysis.Rmd" class="external-link"><code>vignettes/analysis.Rmd</code></a></small>
      <div class="d-none name"><code>analysis.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="why">Why ?<a class="anchor" aria-label="anchor" href="#why"></a>
</h2>
<p>This vignette presents <code><a href="../reference/make_analysis.html">make_analysis()</a></code> and
<code><a href="../reference/make_analysis_from_dap.html">make_analysis_from_dap()</a></code>. More documentation will be added
later for <code>svy_*()</code> functions.</p>
</div>
<div class="section level2">
<h2 id="prepare-data-survey-choices-survey-design">Prepare data, survey, choices, survey design<a class="anchor" aria-label="anchor" href="#prepare-data-survey-choices-survey-design"></a>
</h2>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Si vous n'avez pas encore installé le package</span></span>
<span><span class="co"># devtools::install_github("impactR)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/gnoblet/impactR" class="external-link">impactR</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://gdfe.co/srvyr/" class="external-link">srvyr</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Get data analysis plan</span></span>
<span><span class="fu"><a href="../reference/data.html">data</a></span><span class="op">(</span><span class="va">dap</span><span class="op">)</span></span>
<span><span class="co"># Get survey</span></span>
<span><span class="fu"><a href="../reference/data.html">data</a></span><span class="op">(</span><span class="va">survey</span><span class="op">)</span></span>
<span><span class="co"># Get choices</span></span>
<span><span class="fu"><a href="../reference/data.html">data</a></span><span class="op">(</span><span class="va">choices</span><span class="op">)</span></span>
<span><span class="co"># Get data</span></span>
<span><span class="fu"><a href="../reference/data.html">data</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span></span></code></pre></div>
<p>The Data analysis plan must have the following specs (not
exhaustive):</p>
<ul>
<li>All columns from the included dataset must be present.</li>
<li>Column <code>id_analysis</code> must contain unique identifiers for
using <code><a href="../reference/make_analysis.html">make_analysis()</a></code> with <code>get_label = TRUE</code> or
<code><a href="../reference/make_analysis_from_dap.html">make_analysis_from_dap()</a></code>.</li>
<li>Data must have been imported with <code>ìmport_xlsx()</code> or
<code><a href="../reference/import_csv.html">import_csv()</a></code> or some other way. Yet column names for
multiple choices must follow this pattern “variable_choice1”, with an
underscore between the variable name from the survey sheet and the
choices from the choices sheet. For instance, for the main drinking
water source (if multiple choice), it could be
“w_water_source_surface_water” or “w_water_source_stand_pipe”.</li>
</ul>
<p>Survey and choices sheets must be prepared:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Prepare survey</span></span>
<span><span class="va">survey</span> <span class="op">&lt;-</span> <span class="va">survey</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/split_survey.html">split_survey</a></span><span class="op">(</span><span class="va">type</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="co">#---- If there are multiple languages, rename one of the two to be used to "label"</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename</a></span><span class="op">(</span>label <span class="op">=</span> <span class="va">label</span><span class="op">)</span></span>
<span>  </span>
<span><span class="va">choices</span> <span class="op">&lt;-</span> <span class="va">choices</span> <span class="op">|&gt;</span> </span>
<span>  <span class="co">#---- If there are multiple languages, rename one of the two to be used to "label"</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename</a></span><span class="op">(</span>label <span class="op">=</span> <span class="va">label</span><span class="op">)</span></span></code></pre></div>
<p>Let’s set your survey design with respect to the sampling
(required):</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Prepare survey design</span></span>
<span><span class="co"># For instance, below is a stratified sampling</span></span>
<span><span class="va">design</span> <span class="op">&lt;-</span> <span class="va">data</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="http://gdfe.co/srvyr/reference/as_survey_design.html" class="external-link">as_survey_design</a></span><span class="op">(</span></span>
<span>    strata <span class="op">=</span> <span class="va">i_zad</span>,</span>
<span>    weights <span class="op">=</span> <span class="va">weights</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="analysis-for-one-variable-of-for-a-ratio">Analysis for one variable of for a ratio<a class="anchor" aria-label="anchor" href="#analysis-for-one-variable-of-for-a-ratio"></a>
</h2>
<p>Let’s say you don’t have a full DAP sheet, and you just want to make
individual analyses.</p>
<p>1- Proportion for a single choice question :</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Single choice question</span></span>
<span><span class="fu"><a href="../reference/make_analysis.html">make_analysis</a></span><span class="op">(</span><span class="va">design</span>, <span class="va">survey</span>, <span class="va">choices</span>, <span class="va">h_3_acces_latrine</span>, <span class="st">"prop_simple"</span>, level <span class="op">=</span> <span class="fl">0.95</span>, vartype <span class="op">=</span> <span class="st">"ci"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Single choice question, do not get labels of choices</span></span>
<span><span class="fu"><a href="../reference/make_analysis.html">make_analysis</a></span><span class="op">(</span><span class="va">design</span>, <span class="va">survey</span>, <span class="va">choices</span>, <span class="va">h_3_acces_latrine</span>, <span class="st">"prop_simple"</span>, get_label <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Single choice question, with group being the stratum</span></span>
<span><span class="fu"><a href="../reference/make_analysis.html">make_analysis</a></span><span class="op">(</span><span class="va">design</span>, <span class="va">survey</span>, <span class="va">choices</span>, <span class="va">h_3_acces_latrine</span>, <span class="st">"prop_simple"</span>, group <span class="op">=</span> <span class="st">"i_zad"</span><span class="op">)</span></span></code></pre></div>
<p>2- Proportion overall: calculate the proportion with NAs as a
category</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Single choice question</span></span>
<span><span class="fu"><a href="../reference/make_analysis.html">make_analysis</a></span><span class="op">(</span><span class="va">design</span>, <span class="va">survey</span>, <span class="va">choices</span>, <span class="va">i_statut</span>, <span class="st">"prop_simple_overall"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Single choice with a label for the NA category</span></span>
<span><span class="fu"><a href="../reference/make_analysis.html">make_analysis</a></span><span class="op">(</span><span class="va">design</span>, <span class="va">survey</span>, <span class="va">choices</span>, <span class="va">i_statut</span>, <span class="st">"prop_simple_overall"</span>, none_label <span class="op">=</span> <span class="st">"Non précisé"</span><span class="op">)</span></span></code></pre></div>
<p>3- Multiple proportion</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Multiple choice question</span></span>
<span><span class="fu"><a href="../reference/make_analysis.html">make_analysis</a></span><span class="op">(</span><span class="va">design</span>, <span class="va">survey</span>, <span class="va">choices</span>, <span class="va">h_3_type_latrine</span>, <span class="st">"prop_multiple"</span>, level <span class="op">=</span> <span class="fl">0.95</span>, vartype <span class="op">=</span> <span class="st">"ci"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Multiple choice question, with no label and with groups</span></span>
<span><span class="fu"><a href="../reference/make_analysis.html">make_analysis</a></span><span class="op">(</span><span class="va">design</span>, <span class="va">survey</span>, <span class="va">choices</span>, <span class="va">r_besoin_assistance</span>, <span class="st">"prop_multiple"</span>, get_label <span class="op">=</span> <span class="cn">FALSE</span>, group <span class="op">=</span> <span class="st">"i_zad"</span><span class="op">)</span></span></code></pre></div>
<p>4- Multiple proportion overall: calculate the proportion for each
choice out of the entire dataset (replaces NAs by 0s in the dummy
columns):</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Multiple choice question</span></span>
<span><span class="fu"><a href="../reference/make_analysis.html">make_analysis</a></span><span class="op">(</span><span class="va">design</span>, <span class="va">survey</span>, <span class="va">choices</span>, <span class="va">h_3_type_latrine</span>, <span class="st">"prop_multiple_overall"</span><span class="op">)</span></span></code></pre></div>
<p>5- Mean, median and counting numeric as character</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Mean of interviewee's age</span></span>
<span><span class="fu"><a href="../reference/make_analysis.html">make_analysis</a></span><span class="op">(</span><span class="va">design</span>, <span class="va">survey</span>, <span class="va">choices</span>, <span class="va">i_enquete_age</span>, <span class="st">"mean"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Median of interviewee's age</span></span>
<span><span class="fu"><a href="../reference/make_analysis.html">make_analysis</a></span><span class="op">(</span><span class="va">design</span>, <span class="va">survey</span>, <span class="va">choices</span>, <span class="va">i_enquete_age</span>, <span class="st">"median"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Proportion counting a numeric variable as a character variable</span></span>
<span><span class="co"># Could be used for some particular numeric variables. For instance, daily duration of access to electricity.</span></span>
<span><span class="fu"><a href="../reference/make_analysis.html">make_analysis</a></span><span class="op">(</span><span class="va">design</span>, <span class="va">survey</span>, <span class="va">choices</span>, <span class="va">i_enquete_age</span>, <span class="st">"count_numeric"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Also grouping still works</span></span>
<span><span class="fu"><a href="../reference/make_analysis.html">make_analysis</a></span><span class="op">(</span><span class="va">design</span>, <span class="va">survey</span>, <span class="va">choices</span>, <span class="va">i_enquete_age</span>, <span class="st">"median"</span>, group <span class="op">=</span> <span class="st">"i_zad"</span><span class="op">)</span></span></code></pre></div>
<p>6 - Last but not least, ratios (it automatically does not consider
NAs).</p>
<p>For this, it is only necessary to write a character string with the
two variable names separated by a comma.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Ratio of whatever, just for the example</span></span>
<span><span class="fu"><a href="../reference/make_analysis.html">make_analysis</a></span><span class="op">(</span><span class="va">design</span>, <span class="va">survey</span>, <span class="va">choices</span>, <span class="st">"i_enum_id, i_enquete_age"</span>, <span class="st">"ratio"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="analysis-from-a-dap">Analysis from a dap<a class="anchor" aria-label="anchor" href="#analysis-from-a-dap"></a>
</h2>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># This gives a list</span></span>
<span><span class="fu"><a href="../reference/make_analysis_from_dap.html">make_analysis_from_dap</a></span><span class="op">(</span><span class="va">design</span>, <span class="va">survey</span>, <span class="va">choices</span>, <span class="va">dap</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># This binds all analysis from the DAP into one data frame</span></span>
<span><span class="fu"><a href="../reference/make_analysis_from_dap.html">make_analysis_from_dap</a></span><span class="op">(</span><span class="va">design</span>, <span class="va">survey</span>, <span class="va">choices</span>, <span class="va">dap</span>, bind <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span></code></pre></div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Noblet Guillaume.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
