<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="impactR">
<title>Base de travail avec impactR • impactR</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.1.3/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.1.3/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Base de travail avec impactR">
<meta property="og:description" content="impactR">
<meta property="og:image" content="https://gnoblet.github.io/impactR/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">impactR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.8.4.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/base_de_travail.html">Base de travail avec impactR</a>
    <a class="dropdown-item" href="../articles/cleaning_data.html">Cleaning data</a>
    <a class="dropdown-item" href="../articles/main_workflow.html">Some workflow</a>
    <a class="dropdown-item" href="../articles/nettoyage_de_donnees.html">Nettoyage de données</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/gnoblet/impactR/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Base de travail avec impactR</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/gnoblet/impactR/blob/HEAD/vignettes/base_de_travail.Rmd" class="external-link"><code>vignettes/base_de_travail.Rmd</code></a></small>
      <div class="d-none name"><code>base_de_travail.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="pourquoi">Pourquoi ?<a class="anchor" aria-label="anchor" href="#pourquoi"></a>
</h2>
<p>Cette vignette a pour but d’expliciter l’usage d’<code>impactR</code>
et la manière dont il est possible de l’utiliser dans le cadre d’un
suivi de collecte de données et du nettoyage. Commençons par charger le
package.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Si vous n'avez pas encore installé le package</span></span>
<span><span class="co"># devtools::install_github("impactR)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/gnoblet/impactR" class="external-link">impactR</a></span><span class="op">)</span></span></code></pre></div>
<p>Ci-dessus, on peut charger des données exemple collectées.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load dataset in environment</span></span>
<span><span class="fu"><a href="../reference/data.html">data</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Show the first lines and types of airports' tibble</span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="va">data</span> <span class="op">|&gt;</span> <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html" class="external-link">as_tibble</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">data</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning in as.POSIXlt.POSIXct(x, tz): unable to identify current timezone 'H':</span></span>
<span><span class="co">## please set environment variable 'TZ'</span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 8 × 50</span></span></span>
<span><span class="co">##   uuid  start               end                 today               deviceid    </span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dttm&gt;</span>              <span style="color: #949494; font-style: italic;">&lt;dttm&gt;</span>              <span style="color: #949494; font-style: italic;">&lt;dttm&gt;</span>              <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span> x1    2021-10-18 <span style="color: #949494;">09:08:24</span> 2021-10-18 <span style="color: #949494;">10:01:35</span> 2021-10-18 <span style="color: #949494;">00:00:00</span> collect:tgN…</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">2</span> x2    2021-10-20 <span style="color: #949494;">09:14:47</span> 2021-10-20 <span style="color: #949494;">10:05:22</span> 2021-10-20 <span style="color: #949494;">00:00:00</span> 35557110048…</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">3</span> x3    2021-10-20 <span style="color: #949494;">10:11:14</span> 2021-10-20 <span style="color: #949494;">11:00:07</span> 2021-10-20 <span style="color: #949494;">00:00:00</span> 35557110048…</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">4</span> x4    2021-10-20 <span style="color: #949494;">11:12:05</span> 2021-10-20 <span style="color: #949494;">12:02:57</span> 2021-10-20 <span style="color: #949494;">00:00:00</span> 35557110048…</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">5</span> x5    2021-10-20 <span style="color: #949494;">14:14:36</span> 2021-10-20 <span style="color: #949494;">15:02:31</span> 2021-10-20 <span style="color: #949494;">00:00:00</span> 35557110048…</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">6</span> x6    2021-10-20 <span style="color: #949494;">15:09:11</span> 2021-10-20 <span style="color: #949494;">16:04:35</span> 2021-10-20 <span style="color: #949494;">00:00:00</span> 35557110048…</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">7</span> x7    2021-10-20 <span style="color: #949494;">09:44:15</span> 2021-10-20 <span style="color: #949494;">10:26:34</span> 2021-10-20 <span style="color: #949494;">00:00:00</span> 35557110050…</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">8</span> x8    2021-10-20 <span style="color: #949494;">10:31:55</span> 2021-10-20 <span style="color: #949494;">11:12:48</span> 2021-10-20 <span style="color: #949494;">00:00:00</span> 35557110050…</span></span>
<span><span class="co">## <span style="color: #949494;"># … with 45 more variables: i_enum_id &lt;dbl&gt;, i_enum_genre &lt;chr&gt;,</span></span></span>
<span><span class="co">## <span style="color: #949494;">#   i_admin2 &lt;chr&gt;, i_ville &lt;chr&gt;, i_secteur &lt;chr&gt;, i_info_secteur &lt;chr&gt;,</span></span></span>
<span><span class="co">## <span style="color: #949494;">#   i_zad &lt;chr&gt;, i_zad_1 &lt;chr&gt;, i_consensus &lt;chr&gt;, i_consensus_note &lt;chr&gt;,</span></span></span>
<span><span class="co">## <span style="color: #949494;">#   i_enquete_age &lt;dbl&gt;, i_enquete_genre &lt;chr&gt;, i_statut &lt;chr&gt;,</span></span></span>
<span><span class="co">## <span style="color: #949494;">#   i_note_statut &lt;lgl&gt;, i_statut_1 &lt;chr&gt;, c_note &lt;lgl&gt;, c_chef_menage &lt;chr&gt;,</span></span></span>
<span><span class="co">## <span style="color: #949494;">#   c_n_chef_menage_genre &lt;chr&gt;, c_n_chef_menage_age &lt;dbl&gt;,</span></span></span>
<span><span class="co">## <span style="color: #949494;">#   c_chef_menage_age &lt;dbl&gt;, c_chef_menage_genre &lt;chr&gt;, …</span></span></span>
<span><span class="co">## <span style="color: #949494;"># ℹ Use `colnames()` to see all variable names</span></span></span></code></pre>
<p>La plupart des fonctions de <code>impactR</code> sont écrites en
supposant que les données fournies peuvent être converties en tibble,
puisqu’elles utilisent largement le tidyverse.</p>
<p>Supposons que nous ayons une feuille ‘survey’ composée comme suit
:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/data.html">data</a></span><span class="op">(</span><span class="va">survey</span><span class="op">)</span></span>
<span><span class="va">survey</span> <span class="op">&lt;-</span> <span class="va">survey</span> <span class="op">|&gt;</span> <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html" class="external-link">as_tibble</a></span><span class="op">(</span><span class="va">survey</span><span class="op">)</span></span>
<span></span>
<span><span class="va">survey</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 44 × 12</span></span></span>
<span><span class="co">##    type        name  label hint  requi…¹ choic…² calcu…³ relev…⁴ const…⁵ const…⁶</span></span>
<span><span class="co">##    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 1</span> start       start <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>      <span style="color: #BB0000;">NA</span>      <span style="color: #BB0000;">NA</span>      <span style="color: #BB0000;">NA</span>      <span style="color: #BB0000;">NA</span>      <span style="color: #BB0000;">NA</span>     </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 2</span> end         end   <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>      <span style="color: #BB0000;">NA</span>      <span style="color: #BB0000;">NA</span>      <span style="color: #BB0000;">NA</span>      <span style="color: #BB0000;">NA</span>      <span style="color: #BB0000;">NA</span>     </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 3</span> today       today <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>      <span style="color: #BB0000;">NA</span>      <span style="color: #BB0000;">NA</span>      <span style="color: #BB0000;">NA</span>      <span style="color: #BB0000;">NA</span>      <span style="color: #BB0000;">NA</span>     </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 4</span> deviceid    devi… <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>      <span style="color: #BB0000;">NA</span>      <span style="color: #BB0000;">NA</span>      <span style="color: #BB0000;">NA</span>      <span style="color: #BB0000;">NA</span>      <span style="color: #BB0000;">NA</span>     </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 5</span> select_one… i_en… Code… <span style="color: #BB0000;">NA</span>    TRUE    <span style="color: #BB0000;">NA</span>      <span style="color: #BB0000;">NA</span>      <span style="color: #BB0000;">NA</span>      <span style="color: #BB0000;">NA</span>      <span style="color: #BB0000;">NA</span>     </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 6</span> select_one… i_en… Sexe… <span style="color: #BB0000;">NA</span>    TRUE    <span style="color: #BB0000;">NA</span>      <span style="color: #BB0000;">NA</span>      <span style="color: #BB0000;">NA</span>      <span style="color: #BB0000;">NA</span>      <span style="color: #BB0000;">NA</span>     </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 7</span> hidden      i_ad… Quel… <span style="color: #BB0000;">NA</span>    FALSE   <span style="color: #BB0000;">NA</span>      <span style="color: #BB0000;">NA</span>      <span style="color: #BB0000;">NA</span>      <span style="color: #BB0000;">NA</span>      <span style="color: #BB0000;">NA</span>     </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 8</span> hidden      i_vi… Quel… <span style="color: #BB0000;">NA</span>    FALSE   <span style="color: #BB0000;">NA</span>      <span style="color: #BB0000;">NA</span>      <span style="color: #BB0000;">NA</span>      <span style="color: #BB0000;">NA</span>      <span style="color: #BB0000;">NA</span>     </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 9</span> select_one… i_se… Quel… <span style="color: #BB0000;">NA</span>    TRUE    <span style="color: #BB0000;">NA</span>      <span style="color: #BB0000;">NA</span>      <span style="color: #BB0000;">NA</span>      <span style="color: #BB0000;">NA</span>      <span style="color: #BB0000;">NA</span>     </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">10</span> calculate   i_in… <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>    TRUE    <span style="color: #BB0000;">NA</span>      jr:cho… <span style="color: #BB0000;">NA</span>      <span style="color: #BB0000;">NA</span>      <span style="color: #BB0000;">NA</span>     </span></span>
<span><span class="co">## <span style="color: #949494;"># … with 34 more rows, 2 more variables: given_name &lt;lgl&gt;, default &lt;chr&gt;, and</span></span></span>
<span><span class="co">## <span style="color: #949494;">#   abbreviated variable names ¹​required, ²​choice_filter, ³​calculation,</span></span></span>
<span><span class="co">## <span style="color: #949494;">#   ⁴​relevant, ⁵​constraint, ⁶​constraint_message</span></span></span>
<span><span class="co">## <span style="color: #949494;"># ℹ Use `print(n = ...)` to see more rows, and `colnames()` to see all variable names</span></span></span></code></pre>
<p>La première chose à faire avec l’objet ‘survey’, car il sera utilisé
ailleurs : il faut séparer en deux la colonne ‘type’.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Miseà part l'argument 'col_to_split' (la colonne à séparer), les autres paramètres sont les paramètres par défaut</span></span>
<span><span class="va">survey</span> <span class="op">&lt;-</span> <span class="va">survey</span> <span class="op">|&gt;</span>  </span>
<span>  <span class="fu"><a href="../reference/split_survey.html">split_survey</a></span><span class="op">(</span></span>
<span>    col_to_split <span class="op">=</span> <span class="st">"type"</span>,</span>
<span>    into <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"type"</span>, <span class="st">"list_name"</span><span class="op">)</span>,</span>
<span>    sep <span class="op">=</span> <span class="st">" "</span>,</span>
<span>    fill <span class="op">=</span> <span class="st">"right"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">survey</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 44 × 13</span></span></span>
<span><span class="co">##    type       list_n…¹ name  label hint  requi…² choic…³ calcu…⁴ relev…⁵ const…⁶</span></span>
<span><span class="co">##    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 1</span> start      <span style="color: #BB0000;">NA</span>       start <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>      <span style="color: #BB0000;">NA</span>      <span style="color: #BB0000;">NA</span>      <span style="color: #BB0000;">NA</span>      <span style="color: #BB0000;">NA</span>     </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 2</span> end        <span style="color: #BB0000;">NA</span>       end   <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>      <span style="color: #BB0000;">NA</span>      <span style="color: #BB0000;">NA</span>      <span style="color: #BB0000;">NA</span>      <span style="color: #BB0000;">NA</span>     </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 3</span> today      <span style="color: #BB0000;">NA</span>       today <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>      <span style="color: #BB0000;">NA</span>      <span style="color: #BB0000;">NA</span>      <span style="color: #BB0000;">NA</span>      <span style="color: #BB0000;">NA</span>     </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 4</span> deviceid   <span style="color: #BB0000;">NA</span>       devi… <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>      <span style="color: #BB0000;">NA</span>      <span style="color: #BB0000;">NA</span>      <span style="color: #BB0000;">NA</span>      <span style="color: #BB0000;">NA</span>     </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 5</span> select_one l_enum_… i_en… Code… <span style="color: #BB0000;">NA</span>    TRUE    <span style="color: #BB0000;">NA</span>      <span style="color: #BB0000;">NA</span>      <span style="color: #BB0000;">NA</span>      <span style="color: #BB0000;">NA</span>     </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 6</span> select_one l_genre  i_en… Sexe… <span style="color: #BB0000;">NA</span>    TRUE    <span style="color: #BB0000;">NA</span>      <span style="color: #BB0000;">NA</span>      <span style="color: #BB0000;">NA</span>      <span style="color: #BB0000;">NA</span>     </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 7</span> hidden     <span style="color: #BB0000;">NA</span>       i_ad… Quel… <span style="color: #BB0000;">NA</span>    FALSE   <span style="color: #BB0000;">NA</span>      <span style="color: #BB0000;">NA</span>      <span style="color: #BB0000;">NA</span>      <span style="color: #BB0000;">NA</span>     </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 8</span> hidden     <span style="color: #BB0000;">NA</span>       i_vi… Quel… <span style="color: #BB0000;">NA</span>    FALSE   <span style="color: #BB0000;">NA</span>      <span style="color: #BB0000;">NA</span>      <span style="color: #BB0000;">NA</span>      <span style="color: #BB0000;">NA</span>     </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 9</span> select_one l_secte… i_se… Quel… <span style="color: #BB0000;">NA</span>    TRUE    <span style="color: #BB0000;">NA</span>      <span style="color: #BB0000;">NA</span>      <span style="color: #BB0000;">NA</span>      <span style="color: #BB0000;">NA</span>     </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">10</span> calculate  <span style="color: #BB0000;">NA</span>       i_in… <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>    TRUE    <span style="color: #BB0000;">NA</span>      jr:cho… <span style="color: #BB0000;">NA</span>      <span style="color: #BB0000;">NA</span>     </span></span>
<span><span class="co">## <span style="color: #949494;"># … with 34 more rows, 3 more variables: constraint_message &lt;chr&gt;,</span></span></span>
<span><span class="co">## <span style="color: #949494;">#   given_name &lt;lgl&gt;, default &lt;chr&gt;, and abbreviated variable names ¹​list_name,</span></span></span>
<span><span class="co">## <span style="color: #949494;">#   ²​required, ³​choice_filter, ⁴​calculation, ⁵​relevant, ⁶​constraint</span></span></span>
<span><span class="co">## <span style="color: #949494;"># ℹ Use `print(n = ...)` to see more rows, and `colnames()` to see all variable names</span></span></span></code></pre>
</div>
<div class="section level2">
<h2 id="contrôle-de-la-qualité-des-données">Contrôle de la qualité des données<a class="anchor" aria-label="anchor" href="#contr%C3%B4le-de-la-qualit%C3%A9-des-donn%C3%A9es"></a>
</h2>
<div class="section level3">
<h3 id="journal-de-nettoyage-des-valeurs-aberrantes">Journal de nettoyage des valeurs aberrantes<a class="anchor" aria-label="anchor" href="#journal-de-nettoyage-des-valeurs-aberrantes"></a>
</h3>
<p>Afin de pouvoir obtenir les valeurs dites aberrantes (pour les
variables numériques), vous pouvez utiliser la fonction
<code>make_log_outlier</code> qui permet d’obtenir deux types de valeurs
aberrantes : l’écart par rapport à la moyenne en utilisant la fonction
<code>outliers_sd</code> et l’écart interquartile en utilisant la
fonction <code>outliers_iqr</code>.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Utilitaire pour obtenir toutes les variables numériques</span></span>
<span><span class="co">#numeric_cols(data) #  Obtenir toutes les colonnes numériques : cela inclut par exemple les identifiants numériques des énumérateurs ou les points GPS.</span></span>
<span><span class="co">#numeric_cols(data, survey) # Obtenir toutes les colonnes numériques en utilisant la feuille 'survey' de l'outil Kobo (uniquement les calculate, integer, etc.)</span></span>
<span></span>
<span><span class="co"># Valeurs aberrantes interquartle (règle des 1,5 fois par défaut)</span></span>
<span><span class="co">#outliers_iqr(data, col = i_enquete_age,times = 1.5,  id_col = uuid) # La colonne d'identifiant 'id_col' est habituellement "uuid" avec Kobo</span></span>
<span></span>
<span><span class="co"># Valeurs aberrantes à la moyenne</span></span>
<span><span class="co">#outliers_sd(data, i_enquete_age, times = 3, id_col = uuid)</span></span>
<span></span>
<span><span class="co"># Fabriquer le journal de nettoyage entier pour toutes les variables numériques (en prenant en compte l'outil Kobo)</span></span>
<span><span class="va">log_outliers</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/make_log_outlier.html">make_log_outlier</a></span><span class="op">(</span><span class="va">data</span>, <span class="va">survey</span>, id_col <span class="op">=</span> <span class="va">uuid</span>, <span class="va">today</span>, <span class="va">i_enum_id</span>, <span class="va">i_zad</span><span class="op">)</span></span>
<span><span class="va">log_outliers</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 4 × 16</span></span></span>
<span><span class="co">##   id_check today               i_enu…¹ i_zad uuid  quest…² quest…³ why   feedb…⁴</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dttm&gt;</span>                <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span> outlier  2021-10-20 <span style="color: #949494;">00:00:00</span>       3 wend… x2    i_enqu… Quel e… Outl… Fill in</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">2</span> outlier  2021-10-18 <span style="color: #949494;">00:00:00</span>       8 wend… x1    c_n_ch… Quel e… Outl… Fill in</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">3</span> outlier  2021-10-20 <span style="color: #949494;">00:00:00</span>       3 wend… x2    c_n_ch… Quel e… Outl… Fill in</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">4</span> outlier  2021-10-18 <span style="color: #949494;">00:00:00</span>       8 wend… x1    c_chef… Age ex… Outl… Fill in</span></span>
<span><span class="co">## <span style="color: #949494;"># … with 7 more variables: action &lt;chr&gt;, old_value &lt;dbl&gt;, new_value &lt;chr&gt;,</span></span></span>
<span><span class="co">## <span style="color: #949494;">#   type &lt;chr&gt;, other_parent_question &lt;chr&gt;, other_new_value &lt;chr&gt;,</span></span></span>
<span><span class="co">## <span style="color: #949494;">#   checkdate &lt;chr&gt;, and abbreviated variable names ¹​i_enum_id, ²​question_name,</span></span></span>
<span><span class="co">## <span style="color: #949494;">#   ³​question_label, ⁴​feedback</span></span></span>
<span><span class="co">## <span style="color: #949494;"># ℹ Use `colnames()` to see all variable names</span></span></span></code></pre>
</div>
<div class="section level3">
<h3 id="journal-de-nettoyage-des-autres">Journal de nettoyage des “autres”<a class="anchor" aria-label="anchor" href="#journal-de-nettoyage-des-autres"></a>
</h3>
<p>Cette fonction nécessite que la question Kobo avec la réponse “autre”
soit définie comme “variable” pour la question parent et
“autre_variable” pour la question parent. “autre_” peut être différent
selon les outils et est défini dans la question suivante par l’argument
“autre”, qui est la chaîne de caractères de chaque début de variable
autre codée dans Kobo. Dans l’exemple qui suit, il s’agit de
“autre_”.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Obtenir les autres </span></span>
<span><span class="va">other_cols</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/other_cols.html">other_cols</a></span><span class="op">(</span><span class="va">data</span>, <span class="st">"autre_"</span>, id_col <span class="op">=</span> <span class="va">uuid</span><span class="op">)</span></span>
<span><span class="va">other_cols</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 2 × 4</span></span></span>
<span><span class="co">##   uuid  question_name             old_value                 other_parent_quest…¹</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>               </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span> x5    autre_h_3_type_latrine    Aussi latrines communales h_3_type_latrine    </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">2</span> x7    autre_r_besoin_assistance Un métier                 r_besoin_assistance </span></span>
<span><span class="co">## <span style="color: #949494;"># … with abbreviated variable name ¹​other_parent_question</span></span></span></code></pre>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Obtenir les autres parents</span></span>
<span><span class="fu"><a href="../reference/other_parent_cols.html">other_parent_cols</a></span><span class="op">(</span><span class="va">data</span>, <span class="va">other_cols</span>, <span class="st">"autre_"</span>, id_col <span class="op">=</span> <span class="va">uuid</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 2 × 3</span></span></span>
<span><span class="co">##   uuid  other_parent_question other_old_value            </span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                 <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                      </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span> x5    h_3_type_latrine      latrine_prive_partage autre</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">2</span> x7    r_besoin_assistance   abri_bna secal autre</span></span></code></pre>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Fabriquer le journal de nettoyage des "autres"</span></span>
<span><span class="va">log_others</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/make_log_other.html">make_log_other</a></span><span class="op">(</span><span class="va">data</span>, <span class="va">survey</span>, <span class="st">"autre_"</span>, <span class="va">uuid</span>, <span class="va">today</span>, <span class="va">i_enum_id</span>, <span class="va">i_zad</span><span class="op">)</span> </span>
<span><span class="va">log_others</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 2 × 17</span></span></span>
<span><span class="co">##   id_check today               i_enu…¹ i_zad uuid  quest…² quest…³ why   feedb…⁴</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dttm&gt;</span>                <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span> autre_   2021-10-20 <span style="color: #949494;">00:00:00</span>       3 wend… x5    autre_… Lesque… Othe… Fill in</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">2</span> autre_   2021-10-20 <span style="color: #949494;">00:00:00</span>      12 wend… x7    autre_… De que… Othe… Fill in</span></span>
<span><span class="co">## <span style="color: #949494;"># … with 8 more variables: action &lt;chr&gt;, old_value &lt;chr&gt;, new_value &lt;chr&gt;,</span></span></span>
<span><span class="co">## <span style="color: #949494;">#   type &lt;chr&gt;, other_parent_question &lt;chr&gt;, other_old_value &lt;chr&gt;,</span></span></span>
<span><span class="co">## <span style="color: #949494;">#   other_new_value &lt;chr&gt;, checkdate &lt;chr&gt;, and abbreviated variable names</span></span></span>
<span><span class="co">## <span style="color: #949494;">#   ¹​i_enum_id, ²​question_name, ³​question_label, ⁴​feedback</span></span></span>
<span><span class="co">## <span style="color: #949494;"># ℹ Use `colnames()` to see all variable names</span></span></span></code></pre>
</div>
<div class="section level3">
<h3 id="journal-de-nettoyage-basé-sur-une-liste-de-vérifications">Journal de nettoyage basé sur une liste de vérifications<a class="anchor" aria-label="anchor" href="#journal-de-nettoyage-bas%C3%A9-sur-une-liste-de-v%C3%A9rifications"></a>
</h3>
<p>Il suffit d’avoir produit en amont un fichier Excel de vérification
logique, qu’il est par ailleurs possible de modifier au cours de la
collecte.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/data.html">data</a></span><span class="op">(</span><span class="va">check_list</span><span class="op">)</span></span>
<span><span class="va">check_list</span> <span class="op">&lt;-</span> <span class="va">check_list</span> <span class="op">|&gt;</span> <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html" class="external-link">as_tibble</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">check_list</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 5 × 7</span></span></span>
<span><span class="co">##   id_check question_name     why                    logic…¹ new_v…² action type </span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>             <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span> id1      i_consensus       Pas de consentement p… <span style="color: #949494;">"</span>i_con… <span style="color: #BB0000;">NA</span>      remove char…</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">2</span> id2      survey_duration   Durée d'enquête de mo… <span style="color: #949494;">"</span>surve… <span style="color: #BB0000;">NA</span>      urgen… doub…</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">3</span> id3      survey_duration   Durée d'enquête de pl… <span style="color: #949494;">"</span>surve… <span style="color: #BB0000;">NA</span>      check  doub…</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">4</span> id4      survey_duration   Durée d'enquête de pl… <span style="color: #949494;">"</span>surve… <span style="color: #BB0000;">NA</span>      urgen… doub…</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">5</span> id5      c_chef_menage_age Le ou la cheffe de mé… <span style="color: #949494;">"</span>c_che… <span style="color: #BB0000;">NA</span>      check  doub…</span></span>
<span><span class="co">## <span style="color: #949494;"># … with abbreviated variable names ¹​logical_test, ²​new_value</span></span></span></code></pre>
<p>Le tableur excel de vérifications doit suivre quelques règles pour
pouvoir être lu par les fonctions d’impactR [ajouter la liste]. Par
exemple, il est nécessaire que toutes les variables présentes dans les
tests logiques (colonne ‘logical_test’ du tableau de vérifications)
existent aussi dans les données, objet <code>data</code>. Pour cela, on
peut utiliser la fonction <code>check_check_list</code>, qui vise à
valider ou non un tableur de vérifications logiques [note : elle n’est
pas encore robuste, mais elle permet déjà de faire un certain nombre de
contrôles].</p>
<p>Par exemple, ci-dessous la colonne <code>survey_duration</code>
n’existe pas dans les données <code>data</code>. Pourtant, il y a des
vérifications logiques qui la prennent en compte dans le tableur de
vérifications logiques <code>check_list</code>. Si on lance la commande
suivante, on obtiendrait une erreur :</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/check_check_list.html">check_check_list</a></span><span class="op">(</span><span class="va">check_list</span>, <span class="va">data</span><span class="op">)</span></span>
<span><span class="co"># following column/s from `question_name` is/are missing in `.tbl`: survey_duration, survey_duration, survey_duration</span></span></code></pre></div>
<p>On va donc jouter la colonne de durée d’enquête à l’aide de la
fonction <code>survey_duration</code>. On en profite pour assi ajouter
la différence de temps entre deux enquêtes par enquêteur.rice :</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="va">data</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/survey_duration.html">survey_duration</a></span><span class="op">(</span><span class="va">start</span>, <span class="va">end</span>, new_colname <span class="op">=</span> <span class="st">"survey_duration"</span><span class="op">)</span> <span class="co">#|&gt;</span></span>
<span>  <span class="co"># NOT RUN!</span></span>
<span>  <span class="co"># survey_difftime(start, end, new_colname = "survey_difftime", i_enum_id)</span></span>
<span><span class="va">data</span><span class="op">$</span><span class="va">survey_duration</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 53 51 49 51 48 55 42 41</span></span></code></pre>
<p>On peut vérifier de nouveau le tableur de vérifications logiques
:</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/check_check_list.html">check_check_list</a></span><span class="op">(</span><span class="va">check_list</span>, <span class="va">data</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] TRUE</span></span></code></pre>
<p>Cette fois-ci, c’est bon, la fonction donne <code>TRUE</code>, on
peut donc procéder avec la production du log de nettoyage.</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">log_check_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/make_log_from_check_list.html">make_log_from_check_list</a></span><span class="op">(</span><span class="va">data</span>, <span class="va">survey</span>, <span class="va">check_list</span>, <span class="va">uuid</span>, <span class="va">today</span>, <span class="va">i_enum_id</span>, <span class="va">i_zad</span><span class="op">)</span></span>
<span></span>
<span><span class="va">log_check_list</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 11 × 17</span></span></span>
<span><span class="co">##    id_ch…¹ today               i_enu…² i_zad uuid  quest…³ quest…⁴ why   feedb…⁵</span></span>
<span><span class="co">##    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dttm&gt;</span>                <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 1</span> id1     2021-10-20 <span style="color: #949494;">00:00:00</span>      12 wend… x7    i_cons… <span style="color: #949494;">"</span>Bonjo… Pas … Verifi…</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 2</span> id1     2021-10-20 <span style="color: #949494;">00:00:00</span>      12 wend… x8    i_cons… <span style="color: #949494;">"</span>Bonjo… Pas … Verifi…</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 3</span> id3     2021-10-18 <span style="color: #949494;">00:00:00</span>       8 wend… x1    survey… <span style="color: #949494;">""</span>      Duré… Verifi…</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 4</span> id3     2021-10-20 <span style="color: #949494;">00:00:00</span>       3 wend… x2    survey… <span style="color: #949494;">""</span>      Duré… Verifi…</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 5</span> id3     2021-10-20 <span style="color: #949494;">00:00:00</span>       3 wend… x3    survey… <span style="color: #949494;">""</span>      Duré… Verifi…</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 6</span> id3     2021-10-20 <span style="color: #949494;">00:00:00</span>       3 wend… x4    survey… <span style="color: #949494;">""</span>      Duré… Verifi…</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 7</span> id3     2021-10-20 <span style="color: #949494;">00:00:00</span>       3 wend… x5    survey… <span style="color: #949494;">""</span>      Duré… Verifi…</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 8</span> id3     2021-10-20 <span style="color: #949494;">00:00:00</span>       3 wend… x6    survey… <span style="color: #949494;">""</span>      Duré… Verifi…</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 9</span> id3     2021-10-20 <span style="color: #949494;">00:00:00</span>      12 wend… x7    survey… <span style="color: #949494;">""</span>      Duré… Verifi…</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">10</span> id3     2021-10-20 <span style="color: #949494;">00:00:00</span>      12 wend… x8    survey… <span style="color: #949494;">""</span>      Duré… Verifi…</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">11</span> id5     2021-10-20 <span style="color: #949494;">00:00:00</span>       3 wend… x2    c_chef… <span style="color: #949494;">"</span>Age e… Le o… Verifi…</span></span>
<span><span class="co">## <span style="color: #949494;"># … with 8 more variables: action &lt;chr&gt;, old_value &lt;chr&gt;, new_value &lt;lgl&gt;,</span></span></span>
<span><span class="co">## <span style="color: #949494;">#   type &lt;chr&gt;, other_parent_question &lt;chr&gt;, other_old_value &lt;chr&gt;,</span></span></span>
<span><span class="co">## <span style="color: #949494;">#   other_new_value &lt;chr&gt;, checkdate &lt;chr&gt;, and abbreviated variable names</span></span></span>
<span><span class="co">## <span style="color: #949494;">#   ¹​id_check, ²​i_enum_id, ³​question_name, ⁴​question_label, ⁵​feedback</span></span></span>
<span><span class="co">## <span style="color: #949494;"># ℹ Use `colnames()` to see all variable names</span></span></span></code></pre>
</div>
<div class="section level3">
<h3 id="journal-de-nettoyage-complet-et-exportation">Journal de nettoyage complet et exportation<a class="anchor" aria-label="anchor" href="#journal-de-nettoyage-complet-et-exportation"></a>
</h3>
<p>Pour terminer, il nous suffit de combiner tous ces journaux de
nettoyage en un seul. On peut ensuite l’exporter en fichier excel.</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">log</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">log_outliers</span>, <span class="va">log_check_list</span>, <span class="va">log_others</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span><span class="op">~</span> <span class="va">.x</span> <span class="op">|&gt;</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span><span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/across.html" class="external-link">across</a></span><span class="op">(</span>.fns <span class="op">=</span> <span class="va">as.character</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind.html" class="external-link">bind_rows</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">readr</span><span class="fu">::</span><span class="fu"><a href="https://readr.tidyverse.org/reference/type_convert.html" class="external-link">type_convert</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>Il est aussi possible d’utiliser la fonction
<code>make_all_logs</code> qui combine ces trois fonctions et ne sort
qu’un unique journal de nettoyage.</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">log</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/make_all_logs.html">make_all_logs</a></span><span class="op">(</span><span class="va">data</span>, <span class="va">survey</span>, <span class="va">check_list</span>, <span class="st">"autre_"</span>, <span class="va">uuid</span>, <span class="va">today</span>, <span class="va">i_enum_id</span>, <span class="va">i_zad</span><span class="op">)</span></span>
<span><span class="va">log</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 17 × 17</span></span></span>
<span><span class="co">##    id_check today      i_enum…¹ i_zad uuid  quest…² quest…³ why   feedb…⁴ action</span></span>
<span><span class="co">##    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;date&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 1</span> id1      2021-10-20       12 wend… x7    i_cons… Bonjou… Pas … Verifi… remove</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 2</span> id1      2021-10-20       12 wend… x8    i_cons… Bonjou… Pas … Verifi… remove</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 3</span> id3      2021-10-18        8 wend… x1    survey… <span style="color: #BB0000;">NA</span>      Duré… Verifi… check </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 4</span> id3      2021-10-20        3 wend… x2    survey… <span style="color: #BB0000;">NA</span>      Duré… Verifi… check </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 5</span> id3      2021-10-20        3 wend… x3    survey… <span style="color: #BB0000;">NA</span>      Duré… Verifi… check </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 6</span> id3      2021-10-20        3 wend… x4    survey… <span style="color: #BB0000;">NA</span>      Duré… Verifi… check </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 7</span> id3      2021-10-20        3 wend… x5    survey… <span style="color: #BB0000;">NA</span>      Duré… Verifi… check </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 8</span> id3      2021-10-20        3 wend… x6    survey… <span style="color: #BB0000;">NA</span>      Duré… Verifi… check </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 9</span> id3      2021-10-20       12 wend… x7    survey… <span style="color: #BB0000;">NA</span>      Duré… Verifi… check </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">10</span> id3      2021-10-20       12 wend… x8    survey… <span style="color: #BB0000;">NA</span>      Duré… Verifi… check </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">11</span> id5      2021-10-20        3 wend… x2    c_chef… Age ex… Le o… Verifi… check </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">12</span> autre_   2021-10-20        3 wend… x5    autre_… Lesque… Othe… Fill in check </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">13</span> autre_   2021-10-20       12 wend… x7    autre_… De que… Othe… Fill in check </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">14</span> outlier  2021-10-20        3 wend… x2    i_enqu… Quel e… Outl… Fill in check </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">15</span> outlier  2021-10-18        8 wend… x1    c_n_ch… Quel e… Outl… Fill in check </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">16</span> outlier  2021-10-20        3 wend… x2    c_n_ch… Quel e… Outl… Fill in check </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">17</span> outlier  2021-10-18        8 wend… x1    c_chef… Age ex… Outl… Fill in check </span></span>
<span><span class="co">## <span style="color: #949494;"># … with 7 more variables: old_value &lt;chr&gt;, new_value &lt;chr&gt;, type &lt;chr&gt;,</span></span></span>
<span><span class="co">## <span style="color: #949494;">#   other_parent_question &lt;chr&gt;, other_old_value &lt;chr&gt;, other_new_value &lt;lgl&gt;,</span></span></span>
<span><span class="co">## <span style="color: #949494;">#   checkdate &lt;chr&gt;, and abbreviated variable names ¹​i_enum_id, ²​question_name,</span></span></span>
<span><span class="co">## <span style="color: #949494;">#   ³​question_label, ⁴​feedback</span></span></span>
<span><span class="co">## <span style="color: #949494;"># ℹ Use `colnames()` to see all variable names</span></span></span></code></pre>
<p>Enfin, il existe plusieurs manière d’exporter. Ici on donne l’exemple
avec le package <code>writexl</code>:</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Not run! La plus simple</span></span>
<span><span class="co"># writexl::write_xlsx(log, "output/log.xlsx)</span></span>
<span></span>
<span><span class="co"># On peut y ajouter la date du jour pour permettre le suivi</span></span>
<span><span class="co"># writexl::write_xlsx(log, paste0("output/log_", Sys.Date(), ".xlsx))</span></span></code></pre></div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Noblet Guillaume.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
